<!-- ğŸŒˆ ArriÃ¨re-plan animÃ© -->
<div class="animated-bg-admin"></div>
<div *ngIf="isLoading" class="spinner-container">
  <div class="spinner"></div>
  <p>Chargement des Ã©vÃ©nements...</p>
</div>
<div class="admin-container">
  <!-- ğŸ”” Notification -->
  <div *ngIf="showNotification" class="notification" [class.success]="notificationType === 'success'"
       [class.error]="notificationType === 'error'" [class.slide-out]="!showNotification">
    <i class="fas" [class.fa-check-circle]="notificationType === 'success'"
       [class.fa-exclamation-circle]="notificationType === 'error'"></i>
    {{ notificationMessage }}
  </div>
  <h2>ğŸ¯ Gestion des Ã©vÃ©nements</h2>
  <!-- ğŸ  Bouton flottant vers lâ€™accueil -->
  <a routerLink="/dashboard/admin" class="floating-home-btn" title="Retour Ã  lâ€™accueil">
    ğŸ 
  </a>
  <!-- ğŸ¯ Formulaire -->
  <form (ngSubmit)="saveEvent()" class="event-form">
    <input type="text" placeholder="Titre" [(ngModel)]="newEvent.titre" name="titre" required />
    <input type="text" placeholder="Lieu" [(ngModel)]="newEvent.lieu" name="lieu" required />
    <input type="datetime-local" [(ngModel)]="newEvent.date_debut" name="date_debut" required />
    <input type="datetime-local" [(ngModel)]="newEvent.date_fin" name="date_fin" required />
    <input type="number" min="1" placeholder="CapacitÃ©" [(ngModel)]="newEvent.capacite" name="capacite" required />
    <input type="text" placeholder="CatÃ©gorie" [(ngModel)]="newEvent.categorie" name="categorie" />
    <input type="text" placeholder="Image (URL)" [(ngModel)]="newEvent.image" name="image" (input)="updatePreview()" />

    <div *ngIf="imagePreview" class="image-preview">
      <p>AperÃ§u :</p>
      <img [src]="imagePreview" alt="PrÃ©visualisation" />
    </div>

    <textarea placeholder="Description" [(ngModel)]="newEvent.description" name="description"></textarea>

    <div class="form-actions">
      <button type="submit" class="btn-primary">{{ isEditing ? 'Modifier' : 'CrÃ©er' }}</button>
      <button type="button" (click)="resetForm()" class="btn-secondary">Annuler</button>
    </div>
  </form>

  <hr />


  <!-- ğŸ” Filtre par catÃ©gorie -->
  <div class="filter-admin">
    <label for="categorieFilter">Filtrer par catÃ©gorie :</label>
    <select id="categorieFilter" [(ngModel)]="selectedCategorie" (change)="filtrerEvenements()">
      <option value="">Toutes les catÃ©gories</option>
      <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
    </select>

    <button (click)="resetFiltre()" class="btn-reset">ğŸ”„ RÃ©initialiser</button>
  </div>
</div>


  <!-- ğŸ¯ Cartes d'Ã©vÃ©nements en grille -->
  <div class="event-grid">
    <div class="event-card" *ngFor="let event of paginatedEvents; index as i" [style.animationDelay]="getStaggerDelay(i)">

    <img [src]="getImage(event)" alt="Illustration" />

      <div class="event-info">
        <h3>{{ event.titre }}</h3>
        <p>ğŸ“… {{ event.date_debut }} â†’ {{ event.date_fin }}</p>
        <p>ğŸ“ {{ event.lieu }} | ğŸ‘¥ {{ event.capacite }} pers.</p>
        <p>{{ event.description }}</p>
      </div>

      <div class="event-actions">
        <button (click)="editEvent(event)" class="btn-edit">âœï¸ Modifier</button>
        <button (click)="deleteEvent(event.id)" class="btn-delete">ğŸ—‘ Supprimer</button>
        <button (click)="downloadPdf(event.id)" class="btn-pdf">ğŸ“„ PDF</button>
      </div>
    </div>


    <!-- ğŸŒ Pagination -->
    <div class="pagination-container" *ngIf="totalPages > 1">
      <button (click)="prevPage()" [disabled]="currentPage === 1">â¬… PrÃ©cÃ©dent</button>

      <button *ngFor="let page of [].constructor(totalPages); let i = index"
              [class.active]="currentPage === i + 1"
              (click)="goToPage(i + 1)">
        {{ i + 1 }}
      </button>

      <button (click)="nextPage()" [disabled]="currentPage === totalPages">Suivant â¡</button>
    </div>


  </div>



